
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../quick-start/">
      
      
        <link rel="next" href="../grammar/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.13">
    
    
      
        <title>Tutorial - ChatFlow</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.fad675c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#learning-chatflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ChatFlow" class="md-header__button md-logo" aria-label="ChatFlow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ChatFlow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ChatFlow" class="md-nav__button md-logo" aria-label="ChatFlow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ChatFlow
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ChatFlow
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-first-chatflow-program" class="md-nav__link">
    <span class="md-ellipsis">
      The First ChatFlow Program
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-parrot" class="md-nav__link">
    <span class="md-ellipsis">
      A Parrot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listen" class="md-nav__link">
    <span class="md-ellipsis">
      Listen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#speak" class="md-nav__link">
    <span class="md-ellipsis">
      Speak
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Speak">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#literal-content" class="md-nav__link">
    <span class="md-ellipsis">
      Literal Content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-content" class="md-nav__link">
    <span class="md-ellipsis">
      Variable Content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-content" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Content
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-custom-speak-and-listen-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Define Custom Speak and Listen Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flow-control" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-tributary" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Tributary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#branch" class="md-nav__link">
    <span class="md-ellipsis">
      Branch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Branch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-variable-content" class="md-nav__link">
    <span class="md-ellipsis">
      Matching Variable Content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#equality-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Equality Comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Timeout Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grammar
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Grammar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grammar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grammar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lexical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lexical Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../BNF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Definition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../async/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async Support
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Runtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Context
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../executors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-first-chatflow-program" class="md-nav__link">
    <span class="md-ellipsis">
      The First ChatFlow Program
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-parrot" class="md-nav__link">
    <span class="md-ellipsis">
      A Parrot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listen" class="md-nav__link">
    <span class="md-ellipsis">
      Listen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#speak" class="md-nav__link">
    <span class="md-ellipsis">
      Speak
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Speak">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#literal-content" class="md-nav__link">
    <span class="md-ellipsis">
      Literal Content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-content" class="md-nav__link">
    <span class="md-ellipsis">
      Variable Content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-content" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Content
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-custom-speak-and-listen-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Define Custom Speak and Listen Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flow-control" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-tributary" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Tributary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#branch" class="md-nav__link">
    <span class="md-ellipsis">
      Branch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Branch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-variable-content" class="md-nav__link">
    <span class="md-ellipsis">
      Matching Variable Content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#equality-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Equality Comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Timeout Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="learning-chatflow">Learning ChatFlow</h1>
<h2 id="the-first-chatflow-program">The First ChatFlow Program</h2>
<p>Let's write our first ChatFlow program that says "hello" to the world.</p>
<pre><code class="language-chatflow">flow origin {
  speak &quot;Hello, world!&quot; 
}
</code></pre>
<p>To run this program, you can use the following Python code:</p>
<pre><code class="language-python">from chatflow import Interpreter, Runtime

code = &quot;&quot;&quot;
flow origin {
  speak &quot;Hello, world!&quot; 
}
&quot;&quot;&quot;

interpreter = Interpreter(code=code)
runtime = Runtime(interpreter)
runtime.run() 
</code></pre>
<p>The current program only has one flow called "origin," which serves as the entry point of the entire ChatFlow program.</p>
<p>We first create an <code>Interpreter</code> object using the provided code. Then we use the <code>Interpreter</code> to create a <code>Runtime</code> object. After that, we can execute the program by calling <code>runtime.run()</code>.</p>
<p>So far, we have only passed the code to the ChatFlow. However, soon we will learn how to define our own <code>speak</code> and <code>listen</code> functions, as well as implement our own tributary.</p>
<h2 id="a-parrot">A Parrot</h2>
<p>Our second ChatFlow program will be a parrot that simply echoes the user's input.</p>
<pre><code class="language-chatflow">flow origin {
    listen for message
    speak message
}
</code></pre>
<p>In our parrot program, we store the user input in the variable <code>message</code> and then speak it back to the user.</p>
<p>But what if we want the parrot to continue listening and echoing until we tell it to stop? We can modify the code like this:</p>
<pre><code class="language-chatflow">flow origin {
    while true {
        listen for message
        speak message
    }
}
</code></pre>
<p>If we want the parrot to echo a specific number of times, we can alter the code like this:</p>
<pre><code class="language-chatflow">flow origin {
    variable counter = 0
    while counter &lt; 5 {
        listen for message
        speak message
        counter = counter + 1
    }
}
</code></pre>
<p>In this modified version, we introduce a variable called <code>counter</code> and initialize it to 0. Inside the loop, we listen for a message, speak it, and then increment the counter. The loop continues until the counter reaches 5.</p>
<p>These examples demonstrate how you can use ChatFlow to create simple conversational programs. As you learn more about ChatFlow, you'll be able to define more complex behaviors and interactions.</p>
<h2 id="listen">Listen</h2>
<p>The <code>listen</code> command in ChatFlow allows the program to wait for user input and store it in a variable for further processing. It is a crucial component for creating interactive conversational experiences.</p>
<p>The basic usage of <code>listen</code> involves specifying the type of input to listen for and the variable to store the received input. Here's an example:</p>
<pre><code class="language-chatflow">flow origin {
    listen for message
    speak message
}
</code></pre>
<p>In this example, the program listens for a <code>message</code> from the user. Once the user provides a message, it is stored in the <code>message</code> variable, and the program responds by speaking the same message back to the user. This simple pattern allows the program to act as a parrot, echoing the user's input.</p>
<p>In some scenarios, it may not be desirable to indefinitely listen for user input. For instance, you may want to set a time limit for how long the program waits for input. In such cases, you can use the optional <code>for</code> parameter to specify a timeout duration.</p>
<pre><code class="language-chatflow">flow origin {
    listen for message for 5s
    if timeout {
        speak &quot;Timeout occurred.&quot;
    } else {
        speak message
    }
}
</code></pre>
<p>In this modified example, the program listens for a <code>message</code> for a maximum duration of 5 seconds. If no input is received within the specified time, the <code>timeout</code> condition is triggered. Inside the <code>if timeout</code> block, the program speaks "Timeout occurred." If input is received within the time limit, the program proceeds to speak the stored message.</p>
<p>By incorporating the <code>listen</code> command with or without a timeout, you can create interactive conversational flows that respond to user input in real-time.</p>
<h2 id="speak">Speak</h2>
<p>The <code>speak</code> command in ChatFlow is a fundamental component for generating responses and providing information to the user in a conversational manner. It allows the program to communicate with the user by speaking out messages.</p>
<p>Using the <code>speak</code> command is straightforward. Simply provide the content you want the program to speak within quotation marks. Here are a few examples:</p>
<h3 id="literal-content">Literal Content</h3>
<pre><code class="language-chatflow">flow origin {
    speak &quot;Hello, world!&quot;
}
</code></pre>
<p>In this example, the program speaks the literal content "Hello, world!" to the user.</p>
<h3 id="variable-content">Variable Content</h3>
<pre><code class="language-chatflow">flow origin {
    assign &quot;123456&quot; to content
    speak content
}
</code></pre>
<p>This example demonstrates how you can assign a value, such as "123456", to a variable called <code>content</code>. The program then speaks the value stored in the <code>content</code> variable.</p>
<h3 id="dynamic-content">Dynamic Content</h3>
<pre><code class="language-chatflow">flow origin {
    speak &quot;What's your name?&quot;
    listen for name
    speak &quot;Hello, &quot; + name + &quot;!&quot;
}
</code></pre>
<p>In this example, the program first speaks the question "What's your name?". It then listens for the user's input, storing it in the <code>name</code> variable. Finally, it constructs a dynamic message by combining the stored <code>name</code> with other strings and speaks the personalized greeting.</p>
<p>By utilizing the <code>speak</code> command in different ways, you can create engaging and interactive conversations with your program. Whether it's providing static messages, speaking variable content, or dynamically generating responses, the <code>speak</code> command allows for effective communication in a customer service chatbot.</p>
<h2 id="define-custom-speak-and-listen-functions">Define Custom Speak and Listen Functions</h2>
<p>In ChatFlow, you have the flexibility to define your own <code>speak</code> and <code>listen</code> functions to customize the behavior of your program. </p>
<p>A <code>speak</code> function takes a single parameter, which is the content it will speak. It does not require a return value. You can define your own <code>speak</code> function to add additional functionality, such as printing the number of times you speak along with the content. Here's an example:</p>
<pre><code class="language-python">def create_my_speak(initial=0):
    def my_speak_function(message):
        nonlocal initial
        initial += 1
        print(initial, message)

    return my_speak_function

def main():
    interpreter = Interpreter(code=code)
    runtime = Runtime(interpreter, speak_function=create_my_speak())
    runtime.run()
</code></pre>
<p>In this example, we define a <code>create_my_speak</code> function that returns a customized <code>speak</code> function. The <code>create_my_speak</code> function takes an optional initial value parameter and defines the <code>my_speak_function</code> nested function. The <code>my_speak_function</code> increments the <code>initial</code> value and prints the incremented value along with the message content.</p>
<p>A <code>listen</code> function receives a timer value, which specifies the maximum time to wait for user input in second. If the <code>timeout</code> parameter is None, it means that no timeout is required, and the program will listen for customer input indefinitely. The <code>listen</code> function returns the content it hears, or <code>None</code> if a timeout occurs. </p>
<p>The built-in <code>listen</code> function is implemented as follows:</p>
<pre><code class="language-python">def read_input_with_timeout(timeout=None):
    try:
        if timeout is None:
            message = input()
        else:
            message = inputimeout(prompt='', timeout=timeout)
        return message
    except TimeoutOccurred:
        return None
</code></pre>
<p>This function uses the <code>input</code> function from Python's standard library to read user input. If a <code>timeout</code> value is provided, it uses the <code>inputimeout</code> function to limit the waiting time for input. If a timeout occurs, the function returns <code>None</code>.</p>
<p>By defining custom <code>speak</code> and <code>listen</code> functions, you can extend the capabilities of your ChatFlow programs and tailor them to your specific requirements.</p>
<h2 id="flow-control">Flow Control</h2>
<p>When executing a ChatFlow program, it can be visualized as traversing through different flows. Each flow represents a distinct sequence of actions and interactions within the program. As the execution progresses, the program moves from one flow to another based on the logic and control flow defined in the code.</p>
<p>Think of the flows as different destinations or checkpoints in your program. The program starts at the flow origin, which serves as the starting point. From there, it engages other flows using the <code>engage</code> statement to navigate to different sections of the program.</p>
<p>As the program traverses through flows, it executes the code within each flow, performing the defined actions and interacting with the user or external systems as necessary. The program may move back and forth between different flows, depending on the logic and conditions specified in the code.</p>
<p>The flow-based execution model allows you to structure your program's conversations and actions in a modular and organized manner. By breaking down your program into flows, you can isolate different functionalities and make your code more manageable and maintainable.</p>
<p>The flow origin serves as the entry point of the entire program. It is where the execution starts. From the flow origin, you can navigate to other flows using the <code>engage</code> statement.</p>
<p>For example:</p>
<pre><code class="language-chatflow">flow origin {
    while true {
        engage echo
    }
}

flow echo {
    listen for message
    speak message
}
</code></pre>
<p>In this example, the flow origin is defined as a loop that runs indefinitely (<code>while true</code>). Within the loop, the <code>engage</code> statement is used to step into another flow called "echo". This means that the program will leave the current flow and start executing the code in the "echo" flow. Once the code in the "echo" flow is completed, the program will return to the flow origin and continue with the next iteration of the loop.</p>
<p>The "echo" flow listens for a message and then speaks the received message back to the user. It represents a specific sequence of actions that are separate from the flow origin.</p>
<p>By using flows and the <code>engage</code> statement, you can create more complex conversational programs with different paths and interactions. Each flow can have its own set of actions, conditions, and responses. This allows you to structure your program in a modular and organized way, making it easier to understand and maintain.</p>
<h2 id="creating-a-tributary">Creating a Tributary</h2>
<p>In ChatFlow, you can create a tributary to extend the functionality of your conversational programs. Tributaries are external functions that can be seamlessly integrated into your ChatFlow program to perform custom operations. Let's explore an example of creating and utilizing a tributary called "parameter_printer":</p>
<p>To create the tributary, you need to define a flow that engages it. Here's an example flow that utilizes the "parameter_printer" tributary:</p>
<pre><code class="language-chatflow">flow origin {
    listen for message
    store message
    handover parameter_printer
}
</code></pre>
<p>In this example, the flow origin listens for a message from the user and stores it in the conversation's context. Then, it engages the "parameter_printer" tributary using the <code>handover</code> statement.</p>
<p>Now let's define the "parameter_printer" tributary function in Python:</p>
<pre><code class="language-python">@register_tributary(&quot;parameter_printer&quot;)
def parameter_printer(context, speak_function, listen_function):
    para = context.get_parameter()
    speak_function(para)
</code></pre>
<p>In this code snippet, the "parameter_printer" function is registered as a tributary using the <code>@register_tributary</code> decorator. The function takes three parameters: <code>context</code>, <code>speak_function</code>, and <code>listen_function</code>. The <code>context</code> parameter provides access to the conversation's context, allowing you to retrieve stored data. The <code>speak_function</code> parameter represents the function used to speak or output content to the user.</p>
<p>In the "parameter_printer" function, the <code>context.get_parameter()</code> retrieves the stored message from the conversation's context. Then, the <code>speak_function(para)</code> outputs the retrieved message to the user.</p>
<p>By creating this tributary and engaging it within the flow, you can seamlessly incorporate the custom functionality of the "parameter_printer" tributary into your conversational program.</p>
<p>Tributaries in ChatFlow enable you to extend the capabilities of your chatbot or conversational agent by integrating custom logic and actions. They provide a flexible and modular approach to enhance the functionality and interactivity of your conversational programs.</p>
<h2 id="branch">Branch</h2>
<p>Branch control is a crucial aspect of building conversational programs in ChatFlow. It allows the program to make decisions and take different paths based on specific conditions. By using branching statements, you can create more interactive and dynamic chatbot experiences.</p>
<p>To best fit the needs of a chatbot, ChatFlow provides several branching mechanisms. Let's explore some of them:</p>
<h3 id="matching-variable-content">Matching Variable Content</h3>
<p>The <code>match</code> statement is used to compare if a variable matches a specific regular expression pattern. It allows you to perform pattern matching and conditionally execute code based on the result.</p>
<pre><code class="language-chatflow">flow origin {
    listen for question for 5s
    if timeout {
        speak &quot;Timeout, conversation ended.&quot;
    } else if question match &quot;(top up|recharge)&quot; {
        engage charge_flow
    } else {
        speak &quot;Unrecognized request.&quot;
        end
    }
}
</code></pre>
<p>In this example, the program listens for a <code>question</code> for a maximum of 5 seconds. If a timeout occurs, it speaks "Timeout, conversation ended." If the <code>question</code> matches the regular expression pattern <code>(top up|recharge)</code>, it engages the <code>charge_flow</code> flow. Otherwise, it speaks "Unrecognized request" and ends the conversation.</p>
<h3 id="equality-comparison">Equality Comparison</h3>
<p>The <code>equals</code> statement is used to check if two values are equal. It is often used for comparing user input against expected values.</p>
<pre><code class="language-chatflow">flow confirm {
    speak &quot;Do you really want to charge &quot; + n + &quot; yuan? Please answer with 'yes' to proceed or 'no' to cancel.&quot;
    assign false to confirmed
    while not confirmed {
        listen for confirmation
        if confirmation equals &quot;yes&quot; {
            handover charge_tributary
            assign true to confirmed
        } else if confirmation equals &quot;no&quot; {
            speak &quot;Charge cancelled.&quot;
            end
        } else {
            speak &quot;Please answer with 'yes' or 'no' only. Please repeat your choice.&quot;
        }
    }
}
</code></pre>
<p>In this example, the program asks the user if they want to charge a specific amount. It listens for a <code>confirmation</code> and uses the <code>equals</code> statement to compare the input against "yes" and "no". If the confirmation is "yes", it hands over to the <code>charge_tributary</code> flow and sets <code>confirmed</code> to <code>true</code>. If the confirmation is "no", it speaks "Charge cancelled" and ends the conversation. If the confirmation is neither "yes" nor "no", it speaks a reminder message and continues listening for a valid response.</p>
<h3 id="timeout-handling">Timeout Handling</h3>
<p>ChatFlow provides a built-in variable called <code>timeout</code> that is automatically set after a <code>listen</code> statement. It allows you to handle timeouts and take appropriate actions when no input is received within a specified duration.</p>
<pre><code class="language-chatflow">flow origin {
    listen for question for 5s
    if timeout {
        speak &quot;Timeout, conversation ended.&quot;
    } else {
        // Handle user input
    }
}
</code></pre>
<p>In this example, the program listens for a <code>question</code> for a maximum of 5 seconds. If no input is received within the specified time, the <code>timeout</code> condition is triggered. Inside the <code>if timeout</code> block, the program speaks "Timeout, conversation ended." You can use this mechanism to gracefully handle situations where the user takes too long to respond.</p>
<p>By utilizing branching statements like <code>match</code>, <code>equals</code>, and <code>timeout</code>, you can create more sophisticated conversational flows in ChatFlow. These branching mechanisms enable your chatbot to make decisions based on user input and provide appropriate responses, enhancing the interactive and dynamic nature of the conversation.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
    
  </body>
</html>